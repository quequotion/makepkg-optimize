#!/usr/bin/bash
#
#   graphite.sh - Compile with Graphite polyhedral modeling optimization
#

[[ -n "$LIBMAKEPKG_BUILDENV_GRAPHITE_SH" ]] && return
LIBMAKEPKG_BUILDENV_GRAPHITE_SH=1

LIBRARY=${LIBRARY:-'@libmakepkgdir@'}

source "$LIBRARY/util/option.sh"

build_options+=('graphite')
buildenv_functions+=('buildenv_graphite')

buildenv_graphite() {
  if check_buildoption "graphite" "y"; then
    graphiteflags=" -fgraphite-identity -floop-nest-optimize -ftree-loop-distribution -ftree-vectorize"
    CFLAGS+="$graphiteflags"
    CXXFLAGS+="$graphiteflags"
  fi
}
